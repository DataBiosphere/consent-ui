<div ng-include src="'app/header/header.html'"></div>
<div class="container">
    <div class="row no-margin">
        <h2 class="col-lg-6 col-md-6 col-sm-12 col-xs-12 cm-title dataset-color no-padding">
            <img src="../assets/images/icon_dataset_.png" alt="Dataset Catalog icon" class="cm-icons">Dataset
            Catalog<br>

            <div class="cm-title-other-description">Datasets with an associated DUL to apply for secondary use.</div>
        </h2>
        <div class="f-right">
            <button download="" ng-disabled="objectIdList.length === 0" ng-click="DatasetCatalog.download(objectIdList)"
                    class="download-button dataset-download-button dataset-background">
                <span>Download selection</span>
                <span class="cm-icon-button glyphicon glyphicon-download caret-margin" aria-hidden="true"></span>
            </button>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-6 search-reviewed no-padding f-right">
            <div class="search-text">
                <i class="glyphicon glyphicon-search dataset-color"></i>
                <input type="search" class="form-control users-search" placeholder="Enter search term..."
                       ng-model="searchDataset"/>
            </div>
        </div>
    </div>
    <div class="table-wrap">
        <form class="pos-relative">
            <div class="checkbox check-all">
                <input type="checkbox" select-all class="checkbox-inline" id="all">
                <label class="regular-checkbox" for="all"></label>
            </div>
        </form>
        <div ng-class="isAdmin && !isResearcher ? 'table-scroll-admin' : 'table-scroll'">
            <table class="table">
                <thead>
                <tr>
                    <th></th>
                    <th ng-repeat="dictionary in DatasetCatalog.dataSetList.dictionary"
                        class="table-titles dataset-color cell-size">{{dictionary.key}}
                    </th>
                    <th class="table-titles dataset-color cell-size">ConsentId</th>
                    <th class="table-titles dataset-color cell-size">Structured Data Use Limitations</th>
                </tr>
                </thead>
                <tbody>
                <tr dir-paginate="dataSet in DatasetCatalog.dataSetList.catalog | filter: searchDataset | itemsPerPage:10"
                    current-page="pagination.current">
                    <td ng-repeat="property in dataSet.properties" ng-if="property.propertyName =='Dataset ID'">
                        <div class="checkbox">
                            <input type="checkbox" id="{{property.propertyValue}}"
                                   ng-model="checkMod['field_' + pagination.current + $parent.$parent.$index]"
                                   class="checkbox-inline user-checkbox" add-object-id>
                            <label class="regular-checkbox rp-choice-questions"
                                   for="{{property.propertyValue}}"></label>
                        </div>
                    </td>
                    <td class="remove-datasets-col" ng-repeat="property in dataSet.properties" ng-if="property.propertyName =='Dataset ID' && isAdmin && !isResearcher">
                        <a ng-if="dataSet.deletable && isAdmin && !isResearcher" ng-click="DatasetCatalog.openDelete(property.propertyValue)"
                           tooltip="Delete dataset" tooltip-class="tooltip-class" tooltip-trigger
                           tooltip-placement="right">
                            <span class="cm-icon-button glyphicon glyphicon-trash caret-margin default-color"
                                  aria-hidden="true"></span>
                        </a>
                        <a ng-if="!dataSet.deletable && isAdmin && !isResearcher">
                            <span class="cm-icon-button glyphicon glyphicon-trash caret-margin dismiss-color"
                                  aria-hidden="true"></span>
                        </a>
                        <div class="disable-datasets-col">
                            <a ng-if="dataSet.active && isAdmin && !isResearcher" ng-click="DatasetCatalog.openDisable(property.propertyValue)" tooltip="Disable dataset" tooltip-class="tooltip-class" tooltip-trigger tooltip-placement="right">
                                <span class="cm-icon-button glyphicon glyphicon-ok-circle caret-margin dataset-color"
                                      aria-hidden="true"></span>
                            </a>
                            <a ng-if="!dataSet.active && isAdmin && !isResearcher" ng-click="DatasetCatalog.openEnable(property.propertyValue)" tooltip="Enable dataset"
                                tooltip-class="tooltip-class" tooltip-trigger tooltip-placement="right">
                                    <span class="cm-icon-button glyphicon glyphicon-ban-circle caret-margin cancel-color"
                                          aria-hidden="true"></span>
                            </a>
                        </div>
                        <div class="approval-datasets-col">
                            <a ng-if="dataSet.needsApproval && isAdmin && !isResearcher" ng-click="DatasetCatalog.openDisableNeedsApproval(property.propertyValue)" tooltip="Connect with Data Owner" tooltip-class="tooltip-class" tooltip-trigger tooltip-placement="right">
                                <span class="cm-icon-button glyphicon glyphicon-link caret-margin dataset-color" aria-hidden="true"></span>
                            </a>
                            <a ng-if="!dataSet.needsApproval && isAdmin && !isResearcher" ng-click="DatasetCatalog.openEnableNeedsApproval(property.propertyValue)" tooltip="Connect with Data Owner"
                               tooltip-class="tooltip-class" tooltip-trigger tooltip-placement="right">
                                <span class="cm-icon-button glyphicon glyphicon-link caret-margin default-color" aria-hidden="true"></span>
                            </a>
                        </div>
                    </td>

                    <td ng-repeat="property in dataSet.properties" class="table-items cell-size" ng-class="{'dataset-disabled': !dataSet.active}">
                        <p ng-if="property.propertyName !=='dbGAP' ">{{property.propertyValue}}</p>
                        <a href="{{property.propertyValue}}" target="_blank"
                           ng-if="property.propertyName =='dbGAP' && property.propertyValue.length > 0  "
                           class="enabled">Link</a>
                        <a href="{{property.propertyValue}}"
                           ng-if="property.propertyName =='dbGAP' && property.propertyValue.length === 0   "
                           class="disabled">Link</a>
                    <td class="table-items cell-size" ng-class="{'dataset-disabled': !dataSet.active}">{{dataSet.consentId}}</td>
                    <td class="table-items cell-size" ng-class="{'dataset-disabled': !dataSet.active}">{{dataSet.translatedUseRestriction}}</td>

                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="pvotes-pagination dataset-pagination" dir-pagination-controls
             max-size="10"
             direction-links="true"
             boundary-links="true">
        </div>
    </div>
</div>

